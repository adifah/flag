{"ts":1341848386961,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var logger = require('winston');\nvar users = require('../users');\n/*\n * GET home page.\n */\n\n// redirecting the user either to /login or /dashboard\nexports.index = function(req, res){\n    // check if user is logged in\n    if(typeof req.session.auth == 'undefined') {\n        res.redirect(\"/login\");\n    } else {\n        res.redirect(\"/dashboard\");\n    }\n};\n\nexports.login = function(req, res){\n    logger.info(\"new user\");\n    res.render('login', { title: 'Flag-Zigzag Login' });\n};\n\nexports.dashboard = function(req, res){\n    render('dashboard', { title: 'Flag-Zigzag Dashboard' }, req, res);\n};\n\nexports.memorize = function(req, res){\n    render('memorize', { title: 'Flag-Zigzag Memorize' }, req, res);\n};\n\nexports.gpsQuestioning = function(req, res){\n    render('gpsQuestioning', { title: 'Flag-Zigzag GPS-Questioning' }, req, res);\n};\n\nexports.leaderboard = function(req, res){\n    render('leaderboard', { title: 'Flag-Zigzag Leaderboard', 'highscores': getHighscores(req), 'gameName': req.params.gameName }, req, res);\n};\n\nvar getHighscores = function (req) {\n    // get game name here\n    var gameName = req.params.gameName;\n    if(gameName==null) {\n        return null;   \n    } else {\n        return users.getHighscores({\"gameName\": gameName});\n    }\n}\n\nvar render = function (view, vars, req, res) {\n    // check if user is logged in\n    if(typeof req.session.auth == 'undefined') {\n        res.redirect(\"/login\");\n    } else {\n        res.render(view, vars);\n    }\n};\n"]],"start1":0,"start2":0,"length1":0,"length2":1479}]],"length":1479}
